version: 0.2

phases:
  install:
    runtime-versions:
      dotnet: 8
    commands:
      - echo "ğŸš€ Instalando ferramentas..."
      - dotnet tool install -g Amazon.Lambda.Tools || true
      - export PATH="$PATH:$HOME/.dotnet/tools"

  pre_build:
    commands:
      - echo "ğŸ”„ Restaurando dependÃªncias..."
      - cd HelloLambda
      - dotnet restore

  build:
    commands:
      - echo "ğŸ—ï¸ Publicando aplicaÃ§Ã£o..."
      - dotnet publish -c Release -f net8.0 -o ./publish

      - echo "ğŸ“¦ Criando pacote function.zip na raiz..."
      - cd publish
      - zip -r ../../../function.zip .

  post_build:
    commands:
      - echo "âœ… Build concluÃ­do com sucesso."

artifacts:
  files:
    - function.zip
    - appspec.yml
